<section ng-controller="ProductCreateCtrl" ng-init="init()">
  <div class="page-bar">
    <div ncy-breadcrumb></div>
  </div>
  <!-- END PAGE BAR -->
  <!-- BEGIN PAGE TITLE-->
  <h3 class="page-title"> 商品详情
    <small>编辑</small>
  </h3>
  <!-- END PAGE TITLE-->
  <!-- END PAGE HEADER-->
  <div class="row">
    <div class="col-md-12">
      <form name="productForm" class="form-horizontal form-row-seperated" role="form" novalidate>
        <div class="portlet">
          <div class="portlet-title">
            <div class="caption">
              <i class="fa fa-shopping-cart"></i>商品信息
            </div>
            <div class="actions btn-set">
              <button type="button" name="back" class="btn btn-secondary-outline" ui-sref="products.list">
                <i class="fa fa-angle-left"></i> 返回列表
              </button>
              <button class="btn btn-secondary-outline" ng-click="reset()">
                <i class="fa fa-reply"></i> 重置
              </button>
              <button class="btn btn-success" ng-click="create(productForm.$valid)">
                <i class="fa fa-check"></i> 保存
              </button>
              <button class="btn btn-success" ng-click="saveAndContinue()">
                <i class="fa fa-check-circle"></i> 保存并继续编辑
              </button>
              <div class="btn-group">
                <a class="btn btn-success dropdown-toggle" href="javascript:;" data-toggle="dropdown">
                  <i class="fa fa-share"></i> 更多
                  <i class="fa fa-angle-down"></i>
                </a>

                <div class="dropdown-menu pull-right">
                  <li>
                    <a ng-click="copy()"> 复制 </a>
                  </li>
                  <li>
                    <a ng-click="delete()"> 删除 </a>
                  </li>
                  <li class="dropdown-divider"></li>
                  <li>
                    <a href="javascript:;"> 打印 </a>
                  </li>
                </div>
              </div>
            </div>
          </div>
          <div class="portlet-body">
            <div class="tabbable-bordered">
              <ul class="nav nav-tabs">
                <li class="active">
                  <a href="#tab_general" data-toggle="tab"> 基本信息 </a>
                </li>
                <li>
                  <a href="#tab_meta" data-toggle="tab"> 规格参数 </a>
                </li>
                <li>
                  <a href="#tab_images" data-toggle="tab"> 图片 </a>
                </li>
              </ul>
              <div class="tab-content">
                <div class="tab-pane active" id="tab_general">
                  <ng-include src="'modules/products/client/views/create-products-tab-general.client.view.html'"></ng-include>
                </div>
                <div class="tab-pane" id="tab_meta">
                  <div class="form-body">

                  </div>
                </div>
                <div class="tab-pane" id="tab_images" class="product-edit-image-tab">
                  <uib-alert type="danger" ng-show="error" close="closeAlert()" class="margin-bottom-10">
                    <i class="fa fa-warning fa-lg"></i> {{error}}
                  </uib-alert>
                  <div class="text-align-reverse margin-bottom-10">
                    <button class="btn btn-success btn-sm" img-picker-proxy>
                      <i class="fa fa-plus"></i> 添加图片
                      <input type="file" name="imgPicker" id="imgPicker" nv-file-select="" uploader="uploader" multiple   style="display: none">
                    </button>
                    <button class="btn btn-primary btn-sm" ng-click="uploader.uploadAll()" ng-disabled="!uploader.getNotUploadedItems().length">
                      <i class="fa fa-upload"></i> 全部上传
                    </button>
                  </div>

                  <div  style="overflow:auto; max-width: 100%">
                    <table class="table">
                      <thead>
                        <tr>
                          <th width="30%">图片名称</th>
                          <th>排序</th>
                          <th ng-show="uploader.isHTML5">图片大小</th>
                          <th ng-show="uploader.isHTML5">上传进度</th>
                          <th>状态</th>
                          <th>操作</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr ng-repeat="item in uploader.queue" class="product-img-edit-animate-repeat">
                          <td>
                            <strong>{{ item.file.name }}</strong>
                            <!-- Image preview -->
                            <!--auto height-->
                            <!--<div ng-thumb="{ file: item.file, width: 100 }"></div>-->
                            <!--auto width-->
                            <div ng-show="uploader.isHTML5" img-thumb="{ file: item._file, height: 100}"></div>
                            <!--fixed width and height -->
                            <!--<div ng-thumb="{ file: item.file, width: 100, height: 100 }"></div>-->
                          </td>
                          <td></td>
                          <td ng-show="uploader.isHTML5" nowrap>{{ item.file.size/1024/1024|number:2 }} MB</td>
                          <td ng-show="uploader.isHTML5">
                            <div class="progress" style="margin-bottom: 0;">
                              <div class="progress-bar" role="progressbar" ng-style="{ 'width': item.progress + '%' }"></div>
                            </div>
                          </td>
                          <td class="text-center">
                            <span ng-show="item.isSuccess" class="text-success"><i class="fa fa-check"></i></span>
                            <span ng-show="item.isCancel"><i class="fa fa-ban"></i></span>
                            <span ng-show="item.isError" class="text-danger"><i class="fa fa-remove"></i></span>
                          </td>
                          <td nowrap>
                            <button type="button" class="btn btn-success btn-xs" ng-click="item.upload()" ng-disabled="item.isReady || item.isUploading || item.isSuccess">
                              <span class="fa fa-upload"></span> 上传
                            </button>
                            <button type="button" class="btn btn-warning btn-xs" ng-click="item.cancel()" ng-disabled="!item.isUploading">
                              <span class="fa fa-ban"></span> 取消
                            </button>
                            <button type="button" class="btn btn-danger btn-xs" ng-click="item.remove()">
                              <span class="fa fa-trash"></span> 删除
                            </button>
                          </td>
                        </tr>

                        <!-- uploaded image-->
                        <tr ng-repeat="item in product.imgs" class="product-img-edit-animate-repeat">
                          <td>
                            <img ng-src="{{item.url}}" style="max-height: 100px">
                          </td>
                          <td><input type="text" ng-pattern="/\d{1-3}/" style="width: 50px" ng-model="item.sortNo"></td>
                          <td ng-show="uploader.isHTML5" nowrap></td>
                          <td ng-show="uploader.isHTML5">
                            <div class="progress" style="margin-bottom: 0;">
                              <div class="progress-bar" role="progressbar" ng-style="{ 'width': '100%' }"></div>
                            </div>
                          </td>
                          <td class="text-center">
                            <span class="text-success"><i class="fa fa-check"></i></span>
                          </td>
                          <td nowrap>
                            <button type="button" class="btn btn-danger btn-xs" ng-click="removeProductImg(item)">
                              <span class="fa fa-trash"></span> 删除
                            </button>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</section>